/**
 * SPDX-License-Identifier: MIT
 * Copyright 2021 - 2024 (C) Fabian Kl√∂tzl
 */

#include "dna.h"
#include "dna_internal.h"
#include "utils.h"

#include <assert.h>

/*

function generate_table() {
	var a = [];
	a.length = 256;
	a.fill(-1);

	var m = {
		A: 'A',
		C: 'C',
		G: 'G',
		T: 'T',
		U: 'T'
	};

	for (var nucl in m) {
		a[nucl.charCodeAt(0)] = m[nucl].charCodeAt(0);
		a[nucl.toLowerCase().charCodeAt(0)] = m[nucl].charCodeAt(0);
	}

	return a.join();
}

*/

DNA_PUBLIC
const signed char dnax_to_dna4_table[] = {
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, 65, -1, 67, -1, -1, -1, 71, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, 84, 84, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, 65, -1, 67, -1, -1, -1, 71, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, 84, 84, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, -1, -1, -1};

/*

function generate_table() {
	var a = [];
	a.length = 256;
	a.fill(-1);

	var m = {
		A: 'T',
		B: 'V',
		C: 'G',
		D: 'H',
		G: 'C',
		H: 'D',
		K: 'M',
		M: 'K',
		N: 'N',
		R: 'Y',
		S: 'S',
		T: 'A',
		U: 'A', // non-standard
		V: 'B',
		W: 'W',
		Y: 'R',
	};

	for (var nucl in m) {
		a[nucl.charCodeAt(0)] = m[nucl].charCodeAt(0);
		a[nucl.toLowerCase().charCodeAt(0)] =
m[nucl].toLowerCase().charCodeAt(0);
	}

	return a.join();
}

*/

// IUPAC Code see iupac(7)
DNA_PUBLIC
const signed char dnax_revcomp_table[] = {
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, 84,  86,  71,  72,  -1, -1, 67,  68,  -1,  -1, 77,  -1, 75,  78,  -1,
	-1, -1,  89,  83,  65,  65, 66, 87,  -1,  82,  -1, -1,  -1, -1,  -1,  -1,
	-1, 116, 118, 103, 104, -1, -1, 99,  100, -1,  -1, 109, -1, 107, 110, -1,
	-1, -1,  121, 115, 97,  97, 98, 119, -1,  114, -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1,  -1,  -1,  -1,  -1, -1, -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1};

/*

function generate_table() {
	var a = [];
	a.length = 256;
	a.fill(-1);

	var m = "ABCDGHKMNRSTUVWY";

	for (var nucl of m) {
		a[nucl.charCodeAt(0)] = nucl.charCodeAt(0);
		a[nucl.toLowerCase().charCodeAt(0)] =
			nucl.toLowerCase().charCodeAt(0);
	}

	return a.join();
}

*/

DNA_PUBLIC
const signed char dnax_iupac_codes[] = {
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, 65, 66,  67,  68,  -1,  -1,  71,  72,  -1,  -1, 75,  -1, 77,  78,  -1,
	-1, -1, 82,  83,  84,  85,  86,  87,  -1,  89,  -1, -1,  -1, -1,  -1,  -1,
	-1, 97, 98,  99,  100, -1,  -1,  103, 104, -1,  -1, 107, -1, 109, 110, -1,
	-1, -1, 114, 115, 116, 117, 118, 119, -1,  121, -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1,
	-1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,  -1};
